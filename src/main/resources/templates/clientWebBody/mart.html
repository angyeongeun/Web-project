<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
>
<head>
    <meta charset="UTF-8">
    <title>clientWebLayout</title>

    <header th:replace="clientWeb/header :: headerFragment"/>

</head>
<body>

<!-- Breadcrumb Section Begin -->
<section class="breadcrumb-section set-bg" style="background: #1e7e34">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center">
                <div class="breadcrumb__text">
                    <h2><span th:text="${mart}"/></h2>
                    <!--..---------------------------.............-->

                    <!--....................-->
                    <div class="breadcrumb__option">
                        <a href="./index">Home</a>
                        <span>Shop</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Breadcrumb Section End -->

<!-- Product Section Begin -->
<section class="product spad">
    <div class="container">
        <div class="row">

            <!-- clientSidebar-->
            <th:block th:include="clientWeb/martSidebar.html" ></th:block>

            <div class="col-lg-9 col-md-7">
                <!--filter-->
                <th:block th:include="clientWeb/filterItem.html" ></th:block>

                <!-- 제품 데이터 시작-->
                <div class="row">
                    <div class="col-lg-4 col-md-6 col-sm-6" th:each="product : ${productList}">
                        <div class="product__item">
                            <div class="product__item__pic set-bg">
                                <a href="#" data-toggle="modal" data-target="#myModal" class="modaldata"
                                   th:data-id="${product.productId}"
                                   th:data-name="${product.productName}"
                                   th:data-price="${product.productPrice}"
                                   th:data-image="${product.image}"
                                   th:data-content="${product.productContent}"
                                >
                                    <img th:src="@{${product.image}}"></a>
                                <ul class="product__item__pic__hover">
                                    <li><a href="#"><i class="fa fa-heart"></i></a></li>
                                    <li><a href="#"><i class="fa fa-retweet"></i></a></li>
                                    <li th:onclick="|javascript:putInCart('${product.productId}')|">
                                        <a href="#">
                                            <i class="fa fa-shopping-cart"></i></a></li>
                                </ul>
                            </div>
                            <div class="product__item__text">
                                <h6><span th:text="${product.productName}" data-toggle="modal" data-target="#myModal"/>
                                </h6>
                                <h5><span th:text="${product.productPrice}"/>원</h5>
                            </div>
                        </div>
                    </div>
                    <!--Modal-->
                    <th:block th:include="clientWeb/productModal.html" ></th:block>

                    <!-- 제품 데이터 끝-->
                </div>
                <!--페이징-->
                <div th:style="!${productList.isEmpty() ? 'display:block' : 'display:none'}"
                     class="product__pagination pagination justify-content-center">
                    <div>
                        <a th:href="@{'/clientMart/'+${mart}+'?page=0'}"><i class="fa fa-long-arrow-left"></i></a>
                    </div>
                    <div th:each="i : ${#numbers.sequence(startPage, endPage)}">
                        <a th:href="@{'/clientMart/'+${mart}+'?page='+${i}}"><i th:text="${i}+1" ></i></a>
                    </div>
                    <div>
                        <a th:href="@{'/clientMart/'+${mart}+'?page='+${endEndPage}}"><i class="fa fa-long-arrow-right" ></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

</section>
<!-- Product Section End -->

<footer th:replace="clientWeb/footer :: footerFragment"/>

<script type="text/javascript" src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
<script type="text/javascript">

    function putInCart(productId) {
        Swal.fire({
            icon: 'success',
            title: '상품을 장바구니에 보관합니다',
            showConfirmButton: false,
            timer: 1500
        })

        //swal('상품을 장바구니에 넣었습니다.','','success');

        $.ajax({
            url: "/clientMart/putInCart",
            data: {productId:productId},
            type: "POST"
        }).done(function(json) {
        }).error(function(xhr, status, errorThrown) {
            alert(xhr.status);
            alert(errorThrown);
        });

    }

    $(document).ready(function () {
        $('.modaldata').click(function () {
            //$.ajax()
            $('h3.product-name').text($(this).data('name'));
            $('span.product-price').text($(this).data('price')+"won");
            $('span.product-content').text($(this).data('content'));
            $('img.product__details__pic__item--large').attr('src', $(this).data('image'));
        });
    });

</script>

</body>
</html>